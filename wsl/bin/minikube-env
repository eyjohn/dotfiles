
>&2 echo "# Loading minikube environment"

>&2 echo "# Getting Docker Environment"
# Read docker env from minikube and patch paths from WSL
eval $(minikube.exe docker-env --shell bash)
export DOCKER_CERT_PATH=$(wslpath $DOCKER_CERT_PATH)

>&2 echo "# Configuring minikube config"
# Copy minikube config, patch paths, and load as "second" config file
sed -e 's/\\/\//g' -e "s/\s\([A-Z]\):/ \/mnt\/\L\1/" ~/winhome/.kube/config > ~/.kube/config.minikube
[ -z "$KUBECONFIG" ] && export KUBECONFIG=~/.kube/config
[[ ! "$KUBECONFIG" =~ ~/.kube/config.minikube ]] && export KUBECONFIG=~/.kube/config.minikube:$KUBECONFIG

echo "export DOCKER_TLS_VERIFY=\"$DOCKER_TLS_VERIFY\""
echo "export DOCKER_HOST=\"$DOCKER_HOST\""
echo "export DOCKER_CERT_PATH=\"$DOCKER_CERT_PATH\""
echo "export KUBECONFIG=\"$KUBECONFIG\""
echo "# Run this command to configure your shell:"
echo "# eval \$(minikube-env)"
